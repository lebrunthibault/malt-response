---
phase: 01-foundation
plan: 03
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/app/(app)/layout.tsx
  - src/app/(app)/page.tsx
  - src/app/(app)/generate/page.tsx
  - src/app/(app)/documents/page.tsx
  - src/app/(app)/history/page.tsx
  - src/app/(app)/profile/page.tsx
  - src/app/(admin)/admin/page.tsx
  - src/app/(auth)/login/page.tsx
  - src/app/(auth)/callback/route.ts
  - src/app/(auth)/error/page.tsx
  - src/app/page.tsx
  - src/components/layout/sidebar.tsx
  - src/components/layout/header.tsx
autonomous: false

must_haves:
  truths:
    - "Authenticated pages show a sidebar with navigation links"
    - "Each feature area has a placeholder page at the correct route"
    - "Root page redirects to /generate (primary action)"
    - "Login page exists at /login with placeholder UI"
    - "Admin page exists at /admin with placeholder UI"
    - "Sidebar shows Generate, Documents, History, Profile links"
    - "Mobile viewport shows responsive navigation"
  artifacts:
    - path: "src/app/(app)/layout.tsx"
      provides: "App shell with sidebar navigation for authenticated pages"
      min_lines: 20
    - path: "src/components/layout/sidebar.tsx"
      provides: "Sidebar component with navigation links"
      contains: "generate"
    - path: "src/app/(app)/generate/page.tsx"
      provides: "Generate placeholder page"
    - path: "src/app/(app)/documents/page.tsx"
      provides: "Documents placeholder page"
    - path: "src/app/(app)/history/page.tsx"
      provides: "History placeholder page"
    - path: "src/app/(app)/profile/page.tsx"
      provides: "Profile placeholder page"
    - path: "src/app/(admin)/admin/page.tsx"
      provides: "Admin placeholder page"
    - path: "src/app/(auth)/login/page.tsx"
      provides: "Login placeholder page"
    - path: "src/app/(auth)/callback/route.ts"
      provides: "Auth callback route handler"
      contains: "exchangeCodeForSession"
  key_links:
    - from: "src/app/(app)/layout.tsx"
      to: "src/components/layout/sidebar.tsx"
      via: "Sidebar component import"
      pattern: "Sidebar"
    - from: "src/app/page.tsx"
      to: "/generate"
      via: "redirect()"
      pattern: "redirect.*generate"
    - from: "src/app/(auth)/callback/route.ts"
      to: "Supabase Auth"
      via: "exchangeCodeForSession"
      pattern: "exchangeCodeForSession"
---

<objective>
Build the application shell with sidebar navigation, all placeholder pages for every feature area, auth pages, and the admin placeholder. This creates the full route structure users will navigate.

Purpose: All subsequent phases need routes to exist. The sidebar establishes the navigation pattern. Placeholder pages give concrete "slots" for feature development.
Output: Complete page structure with sidebar navigation, placeholder content for generate/documents/history/profile/admin/login.
</objective>

<execution_context>
@/home/thibault/.claude/get-shit-done/workflows/execute-plan.md
@/home/thibault/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sidebar navigation and app shell layout</name>
  <files>
    src/components/layout/sidebar.tsx
    src/components/layout/header.tsx
    src/app/(app)/layout.tsx
  </files>
  <action>
    1. Initialize required shadcn/ui components:
       ```
       npx shadcn@latest add button sheet separator
       ```

    2. Create src/components/layout/sidebar.tsx:
       - 'use client' (needs hooks for active state and mobile toggle)
       - Collapsible sidebar following the "organic, simple" design language
       - Desktop: Fixed sidebar, 240px wide, left side, subtle border-right
       - Mobile: Use shadcn Sheet component (slides from left) triggered by hamburger button
       - Navigation links with Lucide icons:
         - Generate (Sparkles icon) -- primary action, visually emphasized
         - Documents (FileText icon)
         - History (Clock icon)
         - Profile (User icon)
         - Separator
         - Admin (Shield icon) -- only visible when user is admin (for now, always show it; auth-gating comes in Phase 7)
       - Use Next.js Link for navigation
       - Use usePathname() to highlight active link
       - Style: warm background (sidebar-background var), muted text, primary color on active link, generous padding (p-4), rounded items (radius from theme)
       - Keep it simple: no collapsible groups, no nested items, no fancy animations

    3. Create src/components/layout/header.tsx:
       - Simple page header component that accepts a title prop
       - Renders a top bar with: mobile hamburger button (hidden on desktop), page title
       - Clean, minimal -- just h1 with the page title and proper spacing
       - The hamburger button should trigger the sidebar Sheet on mobile

    4. Create src/app/(app)/layout.tsx:
       - Import Sidebar and Header components
       - Desktop layout: sidebar fixed left + main content area with padding
       - Mobile layout: full-width content, sidebar accessible via Sheet
       - Use CSS grid or flex: `grid grid-cols-[240px_1fr]` on lg, full width on mobile
       - Main content area: max-w-4xl or similar, comfortable reading width, centered
       - Do NOT add auth checking here (that's Phase 2). For now, render for everyone.

    Design guidance (Claude's discretion, per CONTEXT.md):
    - "Organic simple design, nothing crazy" -- clean lines, warm colors, no decorative elements
    - Generous whitespace, breathable layout
    - System font stack (Next.js default)
    - Subtle hover states on nav items (opacity or background change)
  </action>
  <verify>
    Run `npm run build` to confirm no TypeScript/import errors. Start dev server and visit localhost:3000 -- sidebar should render with navigation links.
  </verify>
  <done>
    Sidebar component renders with 5 navigation links (Generate, Documents, History, Profile, Admin). App shell layout shows sidebar on desktop, Sheet drawer on mobile. Active link is highlighted.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create all placeholder pages and auth routes</name>
  <files>
    src/app/page.tsx
    src/app/(app)/page.tsx
    src/app/(app)/generate/page.tsx
    src/app/(app)/documents/page.tsx
    src/app/(app)/history/page.tsx
    src/app/(app)/profile/page.tsx
    src/app/(admin)/admin/page.tsx
    src/app/(auth)/login/page.tsx
    src/app/(auth)/callback/route.ts
    src/app/(auth)/error/page.tsx
  </files>
  <action>
    1. src/app/page.tsx (root):
       - Import redirect from 'next/navigation'
       - Immediately redirect to '/generate' (the primary action page)
       - This is a Server Component, no 'use client' needed

    2. src/app/(app)/page.tsx:
       - Redirect to '/generate' (if someone hits the (app) group root)

    3. Placeholder pages for each feature area. Each should be a simple Server Component with:
       - A clear heading indicating the page name
       - A short description of what will be built here (helps during development)
       - Use the Header component for the page title
       - Minimal styling with Tailwind: centered content, muted text for description

       Create these placeholders:
       a. src/app/(app)/generate/page.tsx -- "Generer une reponse" / "Collez une offre Malt et generez une reponse personnalisee"
       b. src/app/(app)/documents/page.tsx -- "Mes documents" / "CV, profil et anciennes reponses"
       c. src/app/(app)/history/page.tsx -- "Historique" / "Vos reponses generees"
       d. src/app/(app)/profile/page.tsx -- "Profil" / "Gerez votre compte"

    4. src/app/(admin)/admin/page.tsx:
       - Placeholder: "Administration" / "Gestion des utilisateurs"
       - No layout needed yet for (admin) group -- it will use root layout
       - Admin auth gating comes in Phase 7

    5. Auth pages:
       a. src/app/(auth)/login/page.tsx:
          - Placeholder login page with centered card layout
          - Title: "Connexion"
          - Subtitle: "Connectez-vous avec votre email"
          - Placeholder for OTP form (just text saying "Formulaire OTP - Phase 2")
          - Clean, centered, card-like container

       b. src/app/(auth)/callback/route.ts:
          - Route handler (GET) that exchanges auth code for session
          - Import createClient from '@/lib/supabase/server'
          - Parse 'code' from searchParams
          - If code: call supabase.auth.exchangeCodeForSession(code)
          - On success: redirect to /generate
          - On error: redirect to /auth/error (note: path within (auth) group)
          - This is needed for OTP/magic link callback in Phase 2

       c. src/app/(auth)/error/page.tsx:
          - Simple error page: "Erreur d'authentification"
          - Link back to /login
          - Centered layout, no sidebar

    IMPORTANT:
    - Auth pages in (auth) group should NOT use the (app) layout with sidebar
    - The (auth) group has no layout.tsx -- pages use root layout directly
    - All text in French (user's language)
  </action>
  <verify>
    Run `npm run build` to confirm all pages compile. Start dev server and manually visit each route:
    - / (should redirect to /generate)
    - /generate, /documents, /history, /profile (placeholder with sidebar)
    - /admin (placeholder, no sidebar)
    - /login (placeholder, no sidebar)
    - /auth/error (error page, no sidebar)
  </verify>
  <done>
    All routes exist and render. Root redirects to /generate. App pages show sidebar navigation. Auth pages render without sidebar. Admin placeholder exists. Auth callback route handler is wired.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete application shell with sidebar navigation, organic theme, and all placeholder pages</what-built>
  <how-to-verify>
    1. Open http://localhost:3000 in your browser (should redirect to /generate)
    2. Verify the sidebar shows on the left with: Generate, Documents, History, Profile, Admin links
    3. Click each link -- each should show a French placeholder page
    4. Verify the organic color theme: warm earthy tones, muted green primary, soft rounded corners
    5. Resize browser to mobile width -- sidebar should collapse, hamburger menu should appear
    6. Open hamburger menu -- sidebar should slide in as a sheet/drawer
    7. Visit /login -- should show centered login placeholder WITHOUT sidebar
    8. Visit /admin -- should show admin placeholder
    9. Overall feel: "organic, simple, nothing crazy" -- does it match your vision?
  </how-to-verify>
  <resume-signal>Type "approved" if the shell looks good, or describe what you'd like changed (colors, layout, spacing, etc.)</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with all pages
2. / redirects to /generate
3. /generate, /documents, /history, /profile render with sidebar
4. /login, /auth/error render WITHOUT sidebar
5. /admin renders with placeholder
6. Sidebar highlights active link
7. Mobile responsive: sidebar collapses to hamburger menu
8. Auth callback route handler exists and handles code exchange
</verification>

<success_criteria>
- All 10 routes exist and render correctly
- Sidebar navigation works with active state highlighting
- Mobile responsive with Sheet drawer for navigation
- Auth callback handles code exchange for Phase 2 OTP flow
- French labels throughout
- Organic, simple design language visible in the theme
- User approves the visual appearance at checkpoint
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
